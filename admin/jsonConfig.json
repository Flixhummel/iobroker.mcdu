{
  "i18n": true,
  "type": "tabs",
  "items": {
    "generalTab": {
      "type": "panel",
      "label": "General Settings",
      "items": {
        "mqttSettings": {
          "type": "panel",
          "label": "MQTT Connection",
          "items": {
            "mqtt.broker": {
              "type": "text",
              "label": "Broker Address",
              "placeholder": "localhost",
              "default": "localhost",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "mqtt.port": {
              "type": "number",
              "label": "Port",
              "default": 1883,
              "min": 1,
              "max": 65535,
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "mqtt.username": {
              "type": "text",
              "label": "Username",
              "default": "iobroker",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "mqtt.password": {
              "type": "password",
              "label": "Password",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "mqtt.topicPrefix": {
              "type": "text",
              "label": "Topic Prefix",
              "default": "mcdu",
              "help": "MQTT topic prefix (lowercase, numbers, dashes, slashes only)",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            }
          }
        },
        "_divider1": {
          "type": "divider"
        },
        "displaySettings": {
          "type": "panel",
          "label": "Display Settings",
          "items": {
            "display.columns": {
              "type": "number",
              "label": "Columns",
              "default": 24,
              "disabled": "true",
              "help": "Fixed by hardware",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "display.rows": {
              "type": "number",
              "label": "Rows",
              "default": 14,
              "disabled": "true",
              "help": "Fixed by hardware",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            }
          }
        },
        "_divider2": {
          "type": "divider"
        },
        "performanceSettings": {
          "type": "panel",
          "label": "Performance",
          "items": {
            "performance.renderThrottle": {
              "type": "number",
              "label": "Render Throttle (ms)",
              "default": 100,
              "min": 50,
              "max": 1000,
              "help": "Minimum time between display updates (prevents flooding)",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "performance.maxQueueSize": {
              "type": "number",
              "label": "Max Queue Size",
              "default": 100,
              "min": 10,
              "max": 1000,
              "help": "Maximum pending display updates",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            }
          }
        }
      }
    },
    "devicePagesTab": {
      "type": "panel",
      "label": "Device & Pages",
      "items": {
        "deviceSection": {
          "type": "panel",
          "label": "Device Selection",
          "items": {
            "_deviceInfo": {
              "type": "staticText",
              "text": "Select a device, then load its page configuration. Edit pages below and save back to the device.",
              "xs": 12,
              "sm": 12,
              "md": 12,
              "lg": 12,
              "xl": 12
            },
            "selectedDevice": {
              "type": "selectSendTo",
              "command": "browseDevices",
              "label": "Device",
              "xs": 12,
              "sm": 12,
              "md": 6,
              "lg": 6,
              "xl": 6
            },
            "_loadWarning": {
              "type": "staticText",
              "text": "Loading will replace the current page configuration in the editor.",
              "style": {"color": "#ff9800", "fontWeight": "bold"},
              "xs": 12,
              "sm": 12,
              "md": 12,
              "lg": 12,
              "xl": 12,
              "hidden": "!data.selectedDevice"
            },
            "loadDevicePagesBtn": {
              "type": "sendTo",
              "command": "loadDevicePages",
              "jsonData": "{\"deviceId\": \"${data.selectedDevice}\"}",
              "useNative": true,
              "variant": "contained",
              "label": "Load Config",
              "showProcess": true,
              "xs": 12,
              "sm": 6,
              "md": 3,
              "lg": 3,
              "xl": 3,
              "disabled": "!data.selectedDevice"
            },
            "saveDevicePagesBtn": {
              "type": "sendTo",
              "command": "saveDevicePages",
              "jsonData": "${JSON.stringify(data)}",
              "useNative": true,
              "variant": "contained",
              "label": "Save Config",
              "showProcess": true,
              "xs": 12,
              "sm": 6,
              "md": 3,
              "lg": 3,
              "xl": 3,
              "disabled": "!data.selectedDevice"
            }
          }
        },
        "_dividerDisplay": {
          "type": "divider",
          "text": "Display",
          "hidden": "!data.selectedDevice"
        },
        "displayDeviceSettings": {
          "type": "panel",
          "hidden": "!data.selectedDevice",
          "items": {
            "display.defaultColor": {
              "type": "select",
              "label": "Default Text Color",
              "options": [
                {"label": "White", "value": "white"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Amber", "value": "amber"},
                {"label": "Red", "value": "red"},
                {"label": "Magenta", "value": "magenta"},
                {"label": "Cyan", "value": "cyan"},
                {"label": "Yellow", "value": "yellow"}
              ],
              "default": "white",
              "xs": 12,
              "sm": 12,
              "md": 4,
              "lg": 4,
              "xl": 4,
              "help": "Default color for data text when no per-line ColData is set"
            },
            "display.brightnessStep": {
              "type": "number",
              "label": "BRT/DIM Step",
              "min": 1,
              "max": 255,
              "default": 20,
              "sm": 12,
              "md": 4,
              "help": "Amount added/subtracted per BRT/DIM button press (0-255 range)"
            },
            "display.startPage": {
              "type": "selectSendTo",
              "command": "getPageList",
              "manual": false,
              "label": "Start Page",
              "sm": 12,
              "md": 4,
              "default": "",
              "help": "Page shown on device connect (default: first page)"
            }
          }
        },
        "_dividerPages": {
          "type": "divider",
          "text": "Pages",
          "hidden": "!data.selectedDevice"
        },
        "pages": {
          "type": "accordion",
          "label": "MCDU Pages",
          "titleAttr": "name",
          "clone": true,
          "hidden": "!data.selectedDevice",
          "items": [
            {
              "type": "text",
              "attr": "id",
              "sm": 12,
              "md": 4,
              "label": "Page ID (auto-generated)",
              "disabled": true,
              "help": "Generated from page name on first save"
            },
            {
              "type": "text",
              "attr": "name",
              "sm": 12,
              "md": 4,
              "label": "Page Name",
              "placeholder": "Hauptmenu",
              "help": "Display name for this page"
            },
            {
              "type": "selectSendTo",
              "attr": "parent",
              "command": "getPageList",
              "manual": false,
              "label": "Parent Page",
              "sm": 12,
              "md": 4,
              "help": "Page ID of parent page (leave empty for root page)"
            },
            {
              "type": "select",
              "attr": "pageNameColor",
              "label": "Page Name Color",
              "sm": 12,
              "md": 4,
              "default": "",
              "help": "Color of the page name in the status bar (default: device default color)",
              "options": [
                {"label": "Default", "value": ""},
                {"label": "White", "value": "white"},
                {"label": "Green", "value": "green"},
                {"label": "Blue", "value": "blue"},
                {"label": "Amber", "value": "amber"},
                {"label": "Red", "value": "red"},
                {"label": "Magenta", "value": "magenta"},
                {"label": "Cyan", "value": "cyan"},
                {"label": "Yellow", "value": "yellow"}
              ]
            },
            {
              "type": "table",
              "attr": "lines",
              "label": "Segment Configuration",
              "sm": 12,
              "items": [
                {
                  "type": "number",
                  "attr": "slot",
                  "title": "Pos.",
                  "width": "50px",
                  "min": 1,
                  "max": 6,
                  "default": 1
                },
                {
                  "type": "select",
                  "attr": "leftButtonType",
                  "title": "L-Type",
                  "width": "90px",
                  "default": "empty",
                  "options": [
                    {"label": "-", "value": "empty"},
                    {"label": "Navigate", "value": "navigation"},
                    {"label": "Datapoint", "value": "datapoint"}
                  ]
                },
                {
                  "type": "text",
                  "attr": "leftLabel",
                  "title": "L-Label",
                  "width": "130px",
                  "default": ""
                },
                {
                  "type": "select",
                  "attr": "leftColLabel",
                  "title": "L-ColLabel",
                  "width": "80px",
                  "default": "",
                  "options": [
                    {"label": "-", "value": ""},
                    {"label": "White", "value": "white"},
                    {"label": "Green", "value": "green"},
                    {"label": "Blue", "value": "blue"},
                    {"label": "Amber", "value": "amber"},
                    {"label": "Red", "value": "red"},
                    {"label": "Magenta", "value": "magenta"},
                    {"label": "Cyan", "value": "cyan"},
                    {"label": "Yellow", "value": "yellow"}
                  ]
                },
                {
                  "type": "text",
                  "attr": "leftText",
                  "title": "L-Data",
                  "width": "130px",
                  "default": "",
                  "hidden": "data.leftButtonType === 'datapoint'"
                },
                {
                  "type": "select",
                  "attr": "leftColData",
                  "title": "L-ColData",
                  "width": "80px",
                  "default": "",
                  "options": [
                    {"label": "-", "value": ""},
                    {"label": "White", "value": "white"},
                    {"label": "Green", "value": "green"},
                    {"label": "Blue", "value": "blue"},
                    {"label": "Amber", "value": "amber"},
                    {"label": "Red", "value": "red"},
                    {"label": "Magenta", "value": "magenta"},
                    {"label": "Cyan", "value": "cyan"},
                    {"label": "Yellow", "value": "yellow"}
                  ]
                },
                {
                  "type": "selectSendTo",
                  "attr": "leftTarget",
                  "title": "L-Target",
                  "command": "getPageList",
                  "manual": false,
                  "width": "120px",
                  "default": "",
                  "hidden": "data.leftButtonType !== 'navigation'"
                },
                {
                  "type": "objectId",
                  "attr": "leftSource",
                  "title": "L-Source",
                  "types": ["state"],
                  "width": "250px",
                  "default": "",
                  "hidden": "data.leftButtonType !== 'datapoint'"
                },
                {
                  "type": "text",
                  "attr": "leftFormat",
                  "title": "L-Fmt",
                  "width": "70px",
                  "default": "",
                  "hidden": "data.leftButtonType !== 'datapoint'"
                },
                {
                  "type": "text",
                  "attr": "leftUnit",
                  "title": "L-Unit",
                  "width": "60px",
                  "default": "",
                  "hidden": "data.leftButtonType !== 'datapoint'"
                },
                {
                  "type": "select",
                  "attr": "rightButtonType",
                  "title": "R-Type",
                  "width": "90px",
                  "default": "empty",
                  "options": [
                    {"label": "-", "value": "empty"},
                    {"label": "Navigate", "value": "navigation"},
                    {"label": "Datapoint", "value": "datapoint"}
                  ]
                },
                {
                  "type": "text",
                  "attr": "rightLabel",
                  "title": "R-Label",
                  "width": "130px",
                  "default": ""
                },
                {
                  "type": "select",
                  "attr": "rightColLabel",
                  "title": "R-ColLabel",
                  "width": "80px",
                  "default": "",
                  "options": [
                    {"label": "-", "value": ""},
                    {"label": "White", "value": "white"},
                    {"label": "Green", "value": "green"},
                    {"label": "Blue", "value": "blue"},
                    {"label": "Amber", "value": "amber"},
                    {"label": "Red", "value": "red"},
                    {"label": "Magenta", "value": "magenta"},
                    {"label": "Cyan", "value": "cyan"},
                    {"label": "Yellow", "value": "yellow"}
                  ]
                },
                {
                  "type": "text",
                  "attr": "rightText",
                  "title": "R-Data",
                  "width": "130px",
                  "default": "",
                  "hidden": "data.rightButtonType === 'datapoint'"
                },
                {
                  "type": "select",
                  "attr": "rightColData",
                  "title": "R-ColData",
                  "width": "80px",
                  "default": "",
                  "options": [
                    {"label": "-", "value": ""},
                    {"label": "White", "value": "white"},
                    {"label": "Green", "value": "green"},
                    {"label": "Blue", "value": "blue"},
                    {"label": "Amber", "value": "amber"},
                    {"label": "Red", "value": "red"},
                    {"label": "Magenta", "value": "magenta"},
                    {"label": "Cyan", "value": "cyan"},
                    {"label": "Yellow", "value": "yellow"}
                  ]
                },
                {
                  "type": "selectSendTo",
                  "attr": "rightTarget",
                  "title": "R-Target",
                  "command": "getPageList",
                  "manual": false,
                  "width": "120px",
                  "default": "",
                  "hidden": "data.rightButtonType !== 'navigation'"
                },
                {
                  "type": "objectId",
                  "attr": "rightSource",
                  "title": "R-Source",
                  "types": ["state"],
                  "width": "250px",
                  "default": "",
                  "hidden": "data.rightButtonType !== 'datapoint'"
                },
                {
                  "type": "text",
                  "attr": "rightFormat",
                  "title": "R-Fmt",
                  "width": "70px",
                  "default": "",
                  "hidden": "data.rightButtonType !== 'datapoint'"
                },
                {
                  "type": "text",
                  "attr": "rightUnit",
                  "title": "R-Unit",
                  "width": "60px",
                  "default": "",
                  "hidden": "data.rightButtonType !== 'datapoint'"
                }
              ]
            }
          ]
        },
        "_dividerFunctionKeys": {
          "type": "divider",
          "text": "Function Keys",
          "hidden": "!data.selectedDevice"
        },
        "functionKeys": {
          "type": "table",
          "label": "Function Key Assignments",
          "sm": 12,
          "noDelete": true,
          "hidden": "!data.selectedDevice",
          "items": [
            {
              "type": "text",
              "attr": "key",
              "title": "Button",
              "width": "80px",
              "readOnly": true
            },
            {
              "type": "checkbox",
              "attr": "enabled",
              "title": "Active",
              "width": "60px"
            },
            {
              "type": "select",
              "attr": "action",
              "title": "Action",
              "width": "140px",
              "options": [
                {"label": "Go to Page", "value": "gotoPage"},
                {"label": "Home (MENU)", "value": "navigateHome"}
              ]
            },
            {
              "type": "selectSendTo",
              "attr": "targetPageId",
              "title": "Target Page",
              "command": "getPageList",
              "manual": false
            }
          ]
        },
        "_dividerTemplate": {
          "type": "divider",
          "text": "Templates",
          "hidden": "!data.selectedDevice"
        },
        "templateSection": {
          "type": "panel",
          "hidden": "!data.selectedDevice",
          "items": {
            "selectedTemplate": {
              "type": "select",
              "label": "Template",
              "options": [
                {"label": "-- Select Template --", "value": ""},
                {"label": "Home Automation", "value": "home"},
                {"label": "Climate Control", "value": "climate"},
                {"label": "Lighting Control", "value": "lights"}
              ],
              "sm": 12,
              "md": 6
            },
            "loadTemplateButton": {
              "type": "sendTo",
              "command": "loadTemplate",
              "jsonData": "{\"templateId\": \"${data.selectedTemplate}\"}",
              "useNative": true,
              "variant": "contained",
              "label": "Apply Template",
              "sm": 12,
              "md": 6
            }
          }
        }
      }
    },
    "advancedAboutTab": {
      "type": "panel",
      "label": "Advanced & About",
      "items": {
        "debugSettings": {
          "type": "panel",
          "label": "Debug Settings",
          "items": {
            "debug.enabled": {
              "type": "checkbox",
              "label": "Enable Debug Logging",
              "default": false,
              "help": "Enable detailed debug logs (affects performance)",
              "sm": 12,
              "md": 6
            },
            "debug.logMqtt": {
              "type": "checkbox",
              "label": "Log MQTT Messages",
              "default": false,
              "help": "Log all MQTT publish/subscribe messages",
              "sm": 12,
              "md": 6
            }
          }
        },
        "_dividerExport": {
          "type": "divider",
          "text": "Configuration Export/Import"
        },
        "exportInfo": {
          "type": "staticText",
          "text": "Use the standard ioBroker config export/import functionality to backup and restore your MCDU configuration."
        },
        "_dividerTestData": {
          "type": "divider",
          "text": "Test Data"
        },
        "testDataInfo": {
          "type": "staticText",
          "text": "Create sample ioBroker states under 0_userdata.0.mcdu_test for testing datapoint rendering."
        },
        "_createTestData": {
          "type": "sendTo",
          "label": "Create Test Data",
          "command": "createSampleData",
          "variant": "outlined",
          "sm": 12,
          "md": 4
        },
        "_dividerAbout": {
          "type": "divider",
          "text": "About"
        },
        "_description": {
          "type": "staticText",
          "text": "<h3>ioBroker MCDU Adapter</h3><p>Aviation-inspired smart home controller using authentic MCDU interface patterns.</p><h4>Display Model</h4><p>Each row has independent <strong>left</strong> and <strong>right</strong> columns, like a real MCDU. Left content is left-aligned (chars 1-12), right content is right-aligned (chars 13-24). Sub-labels appear on even rows in cyan.</p><h4>Per-Device Pages</h4><p>Page configurations are stored per device. Select a device in the Device & Pages tab, load its config, edit, and save back.</p>",
          "sm": 12
        },
        "_version": {
          "type": "staticText",
          "text": "Version: 2.0.0",
          "sm": 12
        },
        "_github": {
          "type": "staticLink",
          "text": "GitHub Repository",
          "href": "https://github.com/Flixhummel/ioBroker.mcdu",
          "sm": 12
        }
      }
    }
  }
}
