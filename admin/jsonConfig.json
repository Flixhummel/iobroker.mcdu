{
  "i18n": true,
  "type": "tabs",
  "items": {
    "mqtt": {
      "type": "panel",
      "label": "MQTT Connection",
      "icon": "settings_input_antenna",
      "items": {
        "_mqttInfo": {
          "type": "staticText",
          "text": "Configure MQTT broker connection. All MCDU devices communicate via MQTT.",
          "sm": 12
        },
        "mqtt.broker": {
          "type": "text",
          "label": "MQTT Broker Address",
          "placeholder": "10.10.5.149",
          "sm": 12,
          "md": 6
        },
        "mqtt.port": {
          "type": "number",
          "label": "Port",
          "default": 1883,
          "min": 1,
          "max": 65535,
          "sm": 12,
          "md": 3
        },
        "mqtt.username": {
          "type": "text",
          "label": "Username",
          "default": "iobroker",
          "sm": 12,
          "md": 6
        },
        "mqtt.password": {
          "type": "password",
          "label": "Password",
          "sm": 12,
          "md": 6
        },
        "mqtt.topicPrefix": {
          "type": "text",
          "label": "Topic Prefix",
          "default": "mcdu",
          "placeholder": "mcdu",
          "help": "MQTT topic structure: {prefix}/{deviceId}/...",
          "sm": 12,
          "md": 6
        }
      }
    },
    "devices": {
      "type": "panel",
      "label": "Device Management",
      "icon": "devices",
      "items": {
        "_deviceInfo": {
          "type": "staticText",
          "text": "MCDU devices auto-register when they connect via MQTT. Each device has its own state tree under devices.{deviceId}.*",
          "sm": 12
        },
        "_deviceSelector": {
          "type": "autocompleteSendTo",
          "label": "Select Device",
          "command": "browseDevices",
          "sm": 12,
          "md": 6,
          "help": "Choose a device to configure its pages"
        },
        "_deviceDetails": {
          "type": "staticText",
          "text": "Device details will appear here when a device is selected",
          "sm": 12,
          "hidden": "!data._deviceSelector"
        }
      }
    },
    "pages": {
      "type": "panel",
      "label": "Page Configuration",
      "icon": "view_list",
      "items": {
        "_pagesInfo": {
          "type": "staticText",
          "text": "Configure pages for the selected device. Each device can have its own page hierarchy.",
          "sm": 12
        },
        "_noDeviceWarning": {
          "type": "staticText",
          "text": "‚ö†Ô∏è Please select a device in the 'Device Management' tab first",
          "sm": 12,
          "style": {
            "color": "orange",
            "fontWeight": "bold"
          },
          "hidden": "!!data._deviceSelector"
        },
        "pages": {
          "type": "table",
          "label": "MCDU Pages",
          "sm": 12,
          "hidden": "!data._deviceSelector",
          "items": [
            {
              "type": "text",
              "attr": "id",
              "title": "Page ID",
              "width": "150px",
              "filter": true,
              "sort": true,
              "placeholder": "home-main"
            },
            {
              "type": "text",
              "attr": "title",
              "title": "Title",
              "width": "200px",
              "filter": true,
              "sort": true,
              "placeholder": "Main Menu"
            },
            {
              "type": "autocompleteSendTo",
              "attr": "parent",
              "title": "Parent Page",
              "width": "150px",
              "command": "browsePages",
              "alsoDependsOn": ["_deviceSelector"]
            },
            {
              "type": "checkbox",
              "attr": "enabled",
              "title": "Enabled",
              "width": "80px",
              "default": true
            },
            {
              "type": "text",
              "attr": "description",
              "title": "Description",
              "width": "250px"
            }
          ]
        },
        "_pageEditor": {
          "type": "accordion",
          "label": "Line Configuration",
          "sm": 12,
          "hidden": "!data._deviceSelector || !data.pages || data.pages.length === 0",
          "items": {
            "_editorInfo": {
              "type": "staticText",
              "text": "Configure the 13 lines for each page. Each line has: left button, display field, right button.",
              "sm": 12
            },
            "_selectedPage": {
              "type": "autocompleteSendTo",
              "label": "Edit Page",
              "command": "browsePages",
              "alsoDependsOn": ["_deviceSelector", "pages"],
              "sm": 12,
              "md": 6
            },
            "_linesConfig": {
              "type": "jsonEditor",
              "label": "Lines Configuration (JSON)",
              "sm": 12,
              "hidden": "!data._selectedPage",
              "help": "Configure 13 lines (rows 1-13). Line 14 is the scratchpad (auto-generated). Example: [{\"row\":1,\"leftButton\":{\"type\":\"navigation\",\"label\":\"HOME\",\"target\":\"home-main\"},\"display\":{\"type\":\"datapoint\",\"source\":\"0_userdata.0.temperature\",\"format\":\"%.1f¬∞C\"},\"rightButton\":{\"type\":\"empty\"}}]"
            }
          }
        },
        "_stateSelector": {
          "type": "accordion",
          "label": "State Browser",
          "sm": 12,
          "hidden": "!data._deviceSelector",
          "items": {
            "_stateBrowserInfo": {
              "type": "staticText",
              "text": "Browse available ioBroker states for use in display fields and button actions.",
              "sm": 12
            },
            "_stateFilter": {
              "type": "text",
              "label": "Filter States",
              "placeholder": "thermostat",
              "sm": 12,
              "md": 6
            },
            "_stateType": {
              "type": "select",
              "label": "State Type",
              "sm": 12,
              "md": 6,
              "options": [
                {"value": "", "label": "All Types"},
                {"value": "number", "label": "Number"},
                {"value": "string", "label": "String"},
                {"value": "boolean", "label": "Boolean"}
              ]
            },
            "_stateList": {
              "type": "autocompleteSendTo",
              "label": "Available States",
              "command": "browseStates",
              "alsoDependsOn": ["_stateFilter", "_stateType"],
              "sm": 12,
              "help": "Copy the state ID and use it in your line configuration"
            }
          }
        }
      }
    },
    "about": {
      "type": "panel",
      "label": "About",
      "icon": "info",
      "items": {
        "_description": {
          "type": "staticText",
          "text": "<h2>ioBroker MCDU Adapter</h2><p>Aviation-inspired smart home controller using authentic MCDU (Multipurpose Control and Display Unit) interface patterns.</p><h3>Features</h3><ul><li>‚úàÔ∏è Authentic cockpit UX (scratchpad, LSK buttons, keypad input)</li><li>üéõÔ∏è Multi-device support (each RasPi = independent device)</li><li>üì° MQTT-based communication</li><li>üè† Smart home integration (thermostats, lights, scenes)</li><li>üìÑ Per-device page configuration</li><li>üîî Device-specific notifications</li></ul><h3>Architecture</h3><p>Each MCDU device has its own state tree under <code>devices.{deviceId}.*</code> with channels for:</p><ul><li><strong>info</strong> - Device status (online, hostname, IP, version)</li><li><strong>display</strong> - Screen content and rendering</li><li><strong>leds</strong> - LED states (FAIL, FM, MCDU, MENU, etc.)</li><li><strong>scratchpad</strong> - Line 14 input buffer</li><li><strong>navigation</strong> - Page navigation state</li><li><strong>notifications</strong> - Device notifications</li><li><strong>actions</strong> - Control commands</li><li><strong>control</strong> - Device control (page switching, refresh)</li></ul>",
          "sm": 12
        },
        "_version": {
          "type": "staticText",
          "text": "Version: 1.1.0",
          "sm": 12
        },
        "_github": {
          "type": "staticLink",
          "text": "GitHub Repository ‚Üí",
          "href": "https://github.com/Flixhummel/mcdu",
          "sm": 12
        },
        "_docs": {
          "type": "staticLink",
          "text": "Documentation ‚Üí",
          "href": "https://github.com/Flixhummel/mcdu/blob/main/README.md",
          "sm": 12
        }
      }
    }
  }
}
